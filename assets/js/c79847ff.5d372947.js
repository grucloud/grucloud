"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[25169],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return d}});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=c(t),d=o,g=m["".concat(s,".").concat(d)]||m[d]||p[d]||r;return t?a.createElement(g,l(l({ref:n},u),{},{components:t})):a.createElement(g,l({ref:n},u))}));function d(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=m;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var c=2;c<r;c++)l[c]=t[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},48398:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return m}});var a=t(87462),o=t(63366),r=(t(67294),t(3905)),l=["components"],i={id:"GoogleGettingStartedExample",title:"GCP Getting Started from an example"},s=void 0,c={unversionedId:"google/GoogleGettingStartedExample",id:"google/GoogleGettingStartedExample",isDocsHomePage:!1,title:"GCP Getting Started from an example",description:"Objective",source:"@site/docs/google/GoogleGettingStartedFromExample.md",sourceDirName:"google",slug:"/google/GoogleGettingStartedExample",permalink:"/docs/google/GoogleGettingStartedExample",tags:[],version:"current",frontMatter:{id:"GoogleGettingStartedExample",title:"GCP Getting Started from an example"}},u=[{value:"Objective",id:"objective",children:[],level:2},{value:"Requirements",id:"requirements",children:[{value:"GCP Account",id:"gcp-account",children:[],level:3},{value:"gcloud",id:"gcloud",children:[],level:3},{value:"Initialise gcloud",id:"initialise-gcloud",children:[],level:3},{value:"SSH keys",id:"ssh-keys",children:[],level:3},{value:"Node.js",id:"nodejs",children:[],level:3},{value:"GruCloud CLI",id:"grucloud-cli",children:[],level:3}],level:2},{value:"Code Architecture",id:"code-architecture",children:[{value:"package.json",id:"packagejson",children:[],level:3},{value:"config.js",id:"configjs",children:[{value:"Project Name and Id",id:"project-name-and-id",children:[],level:4},{value:"stage",id:"stage",children:[],level:4},{value:"Machine name",id:"machine-name",children:[],level:4},{value:"machineType",id:"machinetype",children:[],level:4},{value:"sourceImage",id:"sourceimage",children:[],level:4},{value:"enable-oslogin",id:"enable-oslogin",children:[],level:4}],level:3},{value:"iac.js",id:"iacjs",children:[],level:3}],level:2},{value:"Initialisation",id:"initialisation",children:[{value:"Project",id:"project",children:[],level:3},{value:"API Services",id:"api-services",children:[],level:3},{value:"Service Account",id:"service-account",children:[],level:3},{value:"Roles Binding",id:"roles-binding",children:[],level:3},{value:"Credential file",id:"credential-file",children:[],level:3},{value:"Info",id:"info",children:[],level:3}],level:2},{value:"CLI Workflow",id:"cli-workflow",children:[{value:"Plan",id:"plan",children:[],level:3},{value:"Deploy",id:"deploy",children:[],level:3},{value:"List",id:"list",children:[],level:3},{value:"Update",id:"update",children:[],level:3},{value:"Output",id:"output",children:[],level:3},{value:"Destroy",id:"destroy",children:[],level:3}],level:2},{value:"Next Steps",id:"next-steps",children:[],level:2}],p={toc:u};function m(e){var n=e.components,t=(0,o.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"objective"},"Objective"),(0,r.kt)("p",null,"Let's automate the deployment of a virtual machine on GCP, the Google Cloud Platform."),(0,r.kt)("p",null,"This basic infrastructure is going to be described and configured in Javascript with the GruCloud GCP provider, distributed as the NPM package ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-google"},"@grucloud/provider-google")),(0,r.kt)("p",null,"This diagram represents the target resources that will be deployed:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/google/vm-simple/artifacts/diagram-target.svg",alt:"graph-target-gpc-vm"})),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The diagram is generated with ",(0,r.kt)("inlineCode",{parentName:"p"},"gc graph"))),(0,r.kt)("h2",{id:"requirements"},"Requirements"),(0,r.kt)("h3",{id:"gcp-account"},"GCP Account"),(0,r.kt)("p",null,"Access to the ",(0,r.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/home/dashboard"},"GCP console")," is required to run this tutorial."),(0,r.kt)("h3",{id:"gcloud"},"gcloud"),(0,r.kt)("p",null,"Ensure the GCP CLI called ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/sdk/docs/install"},"gcloud")," is installed:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ gcloud -v\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"Google Cloud SDK 318.0.0\nbeta 2020.11.06\nbq 2.0.62\ncore 2020.11.06\ngsutil 4.54\n")),(0,r.kt)("h3",{id:"initialise-gcloud"},"Initialise gcloud"),(0,r.kt)("p",null,"Initialize ",(0,r.kt)("em",{parentName:"p"},"gcloud")," in order to authenticate your user, as well and setting the default region and zone:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud init\n")),(0,r.kt)("p",null,"Check the config at any time with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud config list\n")),(0,r.kt)("h3",{id:"ssh-keys"},"SSH keys"),(0,r.kt)("p",null,"The section describes how to manage SSH keys to access the virtual machine."),(0,r.kt)("p",null,"First of all, let's list the SSH keys that may have been already created:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute os-login ssh-keys list\n")),(0,r.kt)("p",null,"Describe a specific key with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute os-login ssh-keys describe --key=ad1811081881c04dad627f96b5d20ddd41fd44e31e76fc259c3e2534f75a190b\n")),(0,r.kt)("p",null,"Let's create a new SSH key pair for this project and call it for instance ",(0,r.kt)("inlineCode",{parentName:"p"},"gcp-vm_rsa")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"ssh-keygen -t rsa\n")),(0,r.kt)("p",null,"Upload your ssh keys:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute os-login ssh-keys add --key-file gcp-vm_rsa.pub\n")),(0,r.kt)("h3",{id:"nodejs"},"Node.js"),(0,r.kt)("p",null,"GruCloud is written in Javascript running on ",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org"},"Node.js")),(0,r.kt)("p",null,"Verify the presence of ",(0,r.kt)("em",{parentName:"p"},"node")," and check the version:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"node --version\n")),(0,r.kt)("p",null,"Any version above 14 should be fine."),(0,r.kt)("h3",{id:"grucloud-cli"},"GruCloud CLI"),(0,r.kt)("p",null,"The GruCloud CLI called ",(0,r.kt)("inlineCode",{parentName:"p"},"gc")," can be installed globally with NPM:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm i -g @grucloud/core\n")),(0,r.kt)("p",null,"As a sanity check, display the version with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc --version\n")),(0,r.kt)("p",null,"That's all for these requirements."),(0,r.kt)("h2",{id:"code-architecture"},"Code Architecture"),(0,r.kt)("p",null,"The infrastructure will be configured and described as Javascript code, defined in the following file"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/package.json"},"package.json"),": contains the project dependencies."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/config.js"},"config.js"),": the configuration function."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/resources.js"},"resources.js"),": the infrastructure as (generated) code"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/iac.js"},"iac.js"),": creates a google provider."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/hook.js"},"hook.js"),": user defined function executed after deployment or destruction.")),(0,r.kt)("p",null,"The next sections show how to create a new project from scratch."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"FYI, the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple"},"source code")," for this example.")),(0,r.kt)("p",null,"First of all, create a new folder called for instance ",(0,r.kt)("inlineCode",{parentName:"p"},"vm-simple")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cd")," to it."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"mkdir vm-simple\ncd vm-simple\n")),(0,r.kt)("h3",{id:"packagejson"},"package.json"),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"package.json")," file is usually created with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm init\n")),(0,r.kt)("p",null,"The project depends on libraries distributed on NPM. For this example targeting GCP, install ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-google"},"@grucloud/provider-google")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"@grucloud/core")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install @grucloud/core @grucloud/provider-google\n")),(0,r.kt)("h3",{id:"configjs"},"config.js"),(0,r.kt)("p",null,"The configuration is defined in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/blob/main/examples/google/vm-simple/config.js"},"config.js")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// config.js\nmodule.exports = ({ stage }) => ({\n  projectId: "vm-tuto1-must-be-globally-unique",\n  vm: {\n    name: "web-server",\n    properties: {\n      diskSizeGb: "20",\n      machineType: "f1-micro",\n      sourceImage:\n        "projects/ubuntu-os-cloud/global/images/family/ubuntu-2004-lts",\n      metadata: {\n        items: [\n          {\n            key: "enable-oslogin",\n            value: "True",\n          },\n        ],\n      },\n    },\n  },\n});\n')),(0,r.kt)("h4",{id:"project-name-and-id"},"Project Name and Id"),(0,r.kt)("p",null,"Set the ",(0,r.kt)("inlineCode",{parentName:"p"},"projectId")," and eventually ther ",(0,r.kt)("inlineCode",{parentName:"p"},"projectName"),"."),(0,r.kt)("p",null,"GruCloud will take care of creating the project if necessary."),(0,r.kt)("h4",{id:"stage"},"stage"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"stage")," parameter by default is ",(0,r.kt)("inlineCode",{parentName:"p"},"dev"),". It could be any value such as ",(0,r.kt)("inlineCode",{parentName:"p"},"production"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"uat"),", or any other stages of your deployment."),(0,r.kt)("p",null,"Notice how the ",(0,r.kt)("inlineCode",{parentName:"p"},"projectName")," could be prefixed or suffixed with stage. Or the ",(0,r.kt)("inlineCode",{parentName:"p"},"machineType")," could be a function of the ",(0,r.kt)("inlineCode",{parentName:"p"},"stage"),", hence allowing to use cheaper machines for a specific stage."),(0,r.kt)("h4",{id:"machine-name"},"Machine name"),(0,r.kt)("p",null,"Feel free to choose a machine name, in this case ",(0,r.kt)("em",{parentName:"p"},"web-server"),". Right now it is a static string but could be a function of the stage, or some function could be applied to enforce a style: camelCase, snake-case, PascalCase, or whatever what the requirements are."),(0,r.kt)("h4",{id:"machinetype"},"machineType"),(0,r.kt)("p",null,"The list of available ",(0,r.kt)("em",{parentName:"p"},"machineType")," for a given region is just a command away:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'gcloud compute machine-types list --filter="zone:( southamerica-east1 )"\n')),(0,r.kt)("p",null,"Choosing the right type of machine for your workload is out of scope for this tutorial."),(0,r.kt)("h4",{id:"sourceimage"},"sourceImage"),(0,r.kt)("p",null,"The Operating System to boot on the machine is set with the ",(0,r.kt)("inlineCode",{parentName:"p"},"sourceImage")," field.\nHow to find out the value of this field ? Start list the available images:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute images list\n")),(0,r.kt)("p",null,"The list is long so only the first lines are displayed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"NAME                                                  PROJECT              FAMILY                            DEPRECATED  STATUS\ncentos-7-v20210420                                    centos-cloud         centos-7                                      READY\ncentos-8-v20210420                                    centos-cloud         centos-8                                      READY\nubuntu-2004-focal-v20210429                           ubuntu-os-cloud      ubuntu-2004-lts                               READY\n")),(0,r.kt)("p",null,"The current value for ",(0,r.kt)("inlineCode",{parentName:"p"},"sourceImage")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"projects/ubuntu-os-cloud/global/images/family/ubuntu-2004-lts"),".\nHence, to use the lastest ",(0,r.kt)("em",{parentName:"p"},"centos"),", the sourceImage should be: ",(0,r.kt)("inlineCode",{parentName:"p"},"projects/centos-cloud/global/images/family/centos-8"),", isn'it ?"),(0,r.kt)("h4",{id:"enable-oslogin"},"enable-oslogin"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"enable-oslogin")," key in the ",(0,r.kt)("inlineCode",{parentName:"p"},"metadata")," section tells GCP that the machine will be accesible though a method called ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/compute/docs/instances/managing-instance-access"},"OS Login"),". It is an alternative way of provisioning SSH access to your machine, without worrying about SSH keys sitting on your local computer that could vanished any time."),(0,r.kt)("h3",{id:"iacjs"},"iac.js"),(0,r.kt)("p",null,"Now it is time to create the infrastructure ",(0,r.kt)("strong",{parentName:"p"},"iac.js")," file that describes the architecture:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// iac.js\nconst { GoogleProvider } = require("@grucloud/provider-google");\n\nconst createResources = async ({ provider }) => {\n  const { config } = provider;\n  const server = provider.compute.makeVmInstance({\n    name: config.vm.name,\n    properties: () => config.vm.properties,\n  });\n\n  return {\n    server,\n  };\n};\n\nexports.createStack = async ({ createProvider }) => {\n  const provider = createProvider(GoogleProvider, {\n    createResources,\n    config: require("./config"),\n  });\n  return {\n    provider,\n  };\n};\n')),(0,r.kt)("p",null,"This file must export the ",(0,r.kt)("inlineCode",{parentName:"p"},"createStack")," at least, this function instantiate the provider, in this case the ",(0,r.kt)("inlineCode",{parentName:"p"},"GoogleProvider"),".\nThe helper function ",(0,r.kt)("inlineCode",{parentName:"p"},"createResources")," creates the resources for this provider and return an object with the resources created.\nThe last part is to return an object from ",(0,r.kt)("inlineCode",{parentName:"p"},"createStack")," containing the provider and the resources created from this provider."),(0,r.kt)("h2",{id:"initialisation"},"Initialisation"),(0,r.kt)("p",null,"A few actions need to be performed prior to deploying the resources."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create the project"),(0,r.kt)("li",{parentName:"ul"},"Setup billing for that project"),(0,r.kt)("li",{parentName:"ul"},"Enable the API services"),(0,r.kt)("li",{parentName:"ul"},"Create a service account"),(0,r.kt)("li",{parentName:"ul"},"Create and save the credential file for this service account"),(0,r.kt)("li",{parentName:"ul"},"Update the IAM policy by binding roles to the service account")),(0,r.kt)("p",null,"Don't worry, these preparations steps are fully automated:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc init\n")),(0,r.kt)("p",null,"What to expect now? The next sections explains how to use some ",(0,r.kt)("em",{parentName:"p"},"gcloud")," command to verify what has been created during the ",(0,r.kt)("em",{parentName:"p"},"init")," command."),(0,r.kt)("h3",{id:"project"},"Project"),(0,r.kt)("p",null,"In the GCP world, resources are grouped into a ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.google.com/resource-manager/docs/creating-managing-projects"},"project"),", which are defined by ",(0,r.kt)("inlineCode",{parentName:"p"},"projectName")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"projectId")," in the config file."),(0,r.kt)("p",null,"Let's verify the project has been created:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud projects list\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"PROJECT_ID                      NAME                   PROJECT_NUMBER\nvm-tuto                         vm-tuto                623960601462\n")),(0,r.kt)("p",null,"Perfect, the project has been created automatically based on our config."),(0,r.kt)("h3",{id:"api-services"},"API Services"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"init")," command takes care of enabling the minimum set of API services:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cloudbilling.googleapis.com"),(0,r.kt)("li",{parentName:"ul"},"cloudresourcemanager.googleapis.com"),(0,r.kt)("li",{parentName:"ul"},"iam.googleapis.com"),(0,r.kt)("li",{parentName:"ul"},"serviceusage.googleapis.com")),(0,r.kt)("p",null,"Let's check all the services in the ",(0,r.kt)("em",{parentName:"p"},"enabled")," state:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud services list --enabled\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"NAME                                 TITLE\nbigquery.googleapis.com              BigQuery API\nbigquerystorage.googleapis.com       BigQuery Storage API\ncloudbilling.googleapis.com          Cloud Billing API\nclouddebugger.googleapis.com         Cloud Debugger API\ncloudresourcemanager.googleapis.com  Cloud Resource Manager API\ncloudtrace.googleapis.com            Cloud Trace API\ncompute.googleapis.com               Compute Engine API\ndatastore.googleapis.com             Cloud Datastore API\ndns.googleapis.com                   Cloud DNS API\ndomains.googleapis.com               Cloud Domains API\niam.googleapis.com                   Identity and Access Management (IAM) API\niamcredentials.googleapis.com        IAM Service Account Credentials API\nlogging.googleapis.com               Cloud Logging API\nmonitoring.googleapis.com            Cloud Monitoring API\nnetworkmanagement.googleapis.com     Network Management API\noslogin.googleapis.com               Cloud OS Login API\nservicemanagement.googleapis.com     Service Management API\nserviceusage.googleapis.com          Service Usage API\nsql-component.googleapis.com         Cloud SQL\nstorage-api.googleapis.com           Google Cloud Storage JSON API\nstorage-component.googleapis.com     Cloud Storage\nstorage.googleapis.com               Cloud Storage API\n")),(0,r.kt)("h3",{id:"service-account"},"Service Account"),(0,r.kt)("p",null,"A service account called in the form of ",(0,r.kt)("inlineCode",{parentName:"p"},"grucloud@YouProjecId.iam.gserviceaccount.com")," is created and will be used by GruCloud to talk to the GCP API."),(0,r.kt)("p",null,"Let's retrieve the list of service accounts:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud iam service-accounts list\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"DISPLAY NAME              EMAIL                                                    DISABLED\ngrucloud service account  grucloud@grucloud-test.iam.gserviceaccount.com            False\n")),(0,r.kt)("p",null,"Bingo, the service account has been created successfully."),(0,r.kt)("h3",{id:"roles-binding"},"Roles Binding"),(0,r.kt)("p",null,"Next, the operation is to bind the following roles to the service account ",(0,r.kt)("inlineCode",{parentName:"p"},"grucloud@vm-tuto1.iam.gserviceaccount.com")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"iam.serviceAccountAdmin"),(0,r.kt)("li",{parentName:"ul"},"compute.admin"),(0,r.kt)("li",{parentName:"ul"},"storage.admin"),(0,r.kt)("li",{parentName:"ul"},"storage.objectAdmin"),(0,r.kt)("li",{parentName:"ul"},"dns.admin"),(0,r.kt)("li",{parentName:"ul"},"editor"),(0,r.kt)("li",{parentName:"ul"},"resourcemanager.projectIamAdmin")),(0,r.kt)("p",null,"Ensure the correct roles are bound to the right service account for a given project, here ",(0,r.kt)("inlineCode",{parentName:"p"},"vm-tuto1")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud projects get-iam-policy  vm-tuto1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"bindings:\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/compute.admin\n- members:\n  - serviceAccount:service-571739547473@compute-system.iam.gserviceaccount.com\n  role: roles/compute.serviceAgent\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/dns.admin\n- members:\n  - serviceAccount:571739547473-compute@developer.gserviceaccount.com\n  - serviceAccount:571739547473@cloudservices.gserviceaccount.com\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/editor\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/iam.serviceAccountAdmin\n- members:\n  - user:frederic.heem@gmail.com\n  role: roles/owner\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/resourcemanager.projectIamAdmin\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/storage.admin\n- members:\n  - serviceAccount:grucloud@vm-tuto1.iam.gserviceaccount.com\n  role: roles/storage.objectAdmin\netag: BwXBNb1KkZg=\nversion: 1\n")),(0,r.kt)("p",null,"As expected, the roles are bounded to our service account."),(0,r.kt)("h3",{id:"credential-file"},"Credential file"),(0,r.kt)("p",null,"A credential file is generated and will be stored at ",(0,r.kt)("inlineCode",{parentName:"p"},"/Users/yourusername/.config/gcloud/YourProjectId.json")),(0,r.kt)("p",null,"For your information, here what it looks like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "type": "service_account",\n  "project_id": "vm-tuto1",\n  "private_key_id": "112233445566aabb00d4e4071478a7ca74c",\n  "private_key": "-----BEGIN PRIVATE KEY-----\\nTHE PRIVATE KEY HERE\\n-----END PRIVATE KEY-----\\n",\n  "client_email": "grucloud@vm-tuto1.iam.gserviceaccount.com",\n  "client_id": "123456789858242482",\n  "auth_uri": "https://accounts.google.com/o/oauth2/auth",\n  "token_uri": "https://oauth2.googleapis.com/token",\n  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",\n  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/grucloud%40vm-tuto1.iam.gserviceaccount.com"\n}\n')),(0,r.kt)("p",null,"Ensure to protect the content of this file as it contains sensitive information such as the private key to access the GCP account, and can potentially deploy some costly resources."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"gc")," requires this credential file to connect to the GCP API."),(0,r.kt)("h3",{id:"info"},"Info"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"info")," provides useful information about the project and its configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc info\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'  - provider:\n      name: google\n      type: google\n    projectId: vm-tuto1\n    projectName: vm-tuto1\n    applicationCredentialsFile: /Users/yourusername/.config/gcloud/vm-tuto1.json\n    serviceAccountName: grucloud\n    hasGCloud: true\n    config:\n      vm:\n        name: web-server\n        properties:\n          diskSizeGb: 20\n          machineType: f1-micro\n          sourceImage: projects/ubuntu-os-cloud/global/images/family/ubuntu-2004-lts\n          metadata:\n            items:\n              - key: enable-oslogin\n                value: True\n      managedByTag: -managed-by-gru\n      managedByKey: managed-by\n      managedByValue: grucloud\n      region: southamerica-east1\n      zone: southamerica-east1-b\n\nCommand "gc info" executed in 1s\n')),(0,r.kt)("p",null,"At this stage, the system is ready for deployment."),(0,r.kt)("h2",{id:"cli-workflow"},"CLI Workflow"),(0,r.kt)("p",null,"The infrastructure can be managed with a bunch of commands:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"gc plan")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"gc apply")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"gc list")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"gc destroy"))),(0,r.kt)("h3",{id:"plan"},"Plan"),(0,r.kt)("p",null,"Find out which resources are going to be created, modified or destroyed with the ",(0,r.kt)("a",{parentName:"p",href:"https://www.grucloud.com/docs/cli/PlanQuery"},"plan")," command.\nNo change wuill be made, it is an informative command which queries the GCP API for all the supported resources, compare these lives resources with the resources that shoudl be deployed, as defined in the code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc plan\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Querying resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 6/6\n  \u2713 Querying\n    \u2713 VmInstance 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 VmInstance from google                                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502 \u2502 CREATE: web-server                                                                      \u2502  \u2502\n\u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502 \u2502 kind: compute#instance                                                                  \u2502  \u2502\n\u2502 \u2502 name: web-server                                                                        \u2502  \u2502\n\u2502 \u2502 zone: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1\u2026 \u2502  \u2502\n\u2502 \u2502 machineType: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southameric\u2026 \u2502  \u2502\n\u2502 \u2502 labels:                                                                                 \u2502  \u2502\n\u2502 \u2502   managed-by: grucloud                                                                  \u2502  \u2502\n\u2502 \u2502   stage: dev                                                                            \u2502  \u2502\n\u2502 \u2502 metadata:                                                                               \u2502  \u2502\n\u2502 \u2502   items:                                                                                \u2502  \u2502\n\u2502 \u2502     - key: enable-oslogin                                                               \u2502  \u2502\n\u2502 \u2502       value: True                                                                       \u2502  \u2502\n\u2502 \u2502   kind: compute#metadata                                                                \u2502  \u2502\n\u2502 \u2502 disks:                                                                                  \u2502  \u2502\n\u2502 \u2502   - kind: compute#attachedDisk                                                          \u2502  \u2502\n\u2502 \u2502     type: PERSISTENT                                                                    \u2502  \u2502\n\u2502 \u2502     boot: true                                                                          \u2502  \u2502\n\u2502 \u2502     mode: READ_WRITE                                                                    \u2502  \u2502\n\u2502 \u2502     autoDelete: true                                                                    \u2502  \u2502\n\u2502 \u2502     deviceName: web-server-managed-by-gru                                               \u2502  \u2502\n\u2502 \u2502     initializeParams:                                                                   \u2502  \u2502\n\u2502 \u2502       sourceImage: projects/ubuntu-os-cloud/global/images/family/ubuntu-2004-lts        \u2502  \u2502\n\u2502 \u2502       diskType: projects/vm-tuto1/zones/southamerica-east1-b/diskTypes/pd-standard      \u2502  \u2502\n\u2502 \u2502       diskSizeGb: 20                                                                    \u2502  \u2502\n\u2502 \u2502     diskEncryptionKey:                                                                  \u2502  \u2502\n\u2502 \u2502 networkInterfaces:                                                                      \u2502  \u2502\n\u2502 \u2502   - kind: compute#networkInterface                                                      \u2502  \u2502\n\u2502 \u2502     subnetwork: projects/vm-tuto1/regions/southamerica-east1/subnetworks/default        \u2502  \u2502\n\u2502 \u2502     accessConfigs:                                                                      \u2502  \u2502\n\u2502 \u2502       - kind: compute#accessConfig                                                      \u2502  \u2502\n\u2502 \u2502         name: External NAT                                                              \u2502  \u2502\n\u2502 \u2502         type: ONE_TO_ONE_NAT                                                            \u2502  \u2502\n\u2502 \u2502         networkTier: PREMIUM                                                            \u2502  \u2502\n\u2502 \u2502     aliasIpRanges: []                                                                   \u2502  \u2502\n\u2502 \u2502 displayDevice:                                                                          \u2502  \u2502\n\u2502 \u2502   enableDisplay: false                                                                  \u2502  \u2502\n\u2502 \u2502 canIpForward: false                                                                     \u2502  \u2502\n\u2502 \u2502 scheduling:                                                                             \u2502  \u2502\n\u2502 \u2502   preemptible: false                                                                    \u2502  \u2502\n\u2502 \u2502   onHostMaintenance: MIGRATE                                                            \u2502  \u2502\n\u2502 \u2502   automaticRestart: true                                                                \u2502  \u2502\n\u2502 \u2502   nodeAffinities: []                                                                    \u2502  \u2502\n\u2502 \u2502 deletionProtection: false                                                               \u2502  \u2502\n\u2502 \u2502 reservationAffinity:                                                                    \u2502  \u2502\n\u2502 \u2502   consumeReservationType: ANY_RESERVATION                                               \u2502  \u2502\n\u2502 \u2502 shieldedInstanceConfig:                                                                 \u2502  \u2502\n\u2502 \u2502   enableSecureBoot: false                                                               \u2502  \u2502\n\u2502 \u2502   enableVtpm: true                                                                      \u2502  \u2502\n\u2502 \u2502   enableIntegrityMonitoring: true                                                       \u2502  \u2502\n\u2502 \u2502 confidentialInstanceConfig:                                                             \u2502  \u2502\n\u2502 \u2502   enableConfidentialCompute: false                                                      \u2502  \u2502\n\u2502 \u2502                                                                                         \u2502  \u2502\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider google                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource to deploy on 1 provider\nCommand "gc plan" executed in 6s\n')),(0,r.kt)("p",null,"Have the opportunity to review the change that will be applied next."),(0,r.kt)("h3",{id:"deploy"},"Deploy"),(0,r.kt)("p",null,"Happy with the expected plan? Deploy it now with the ",(0,r.kt)("a",{parentName:"p",href:"https://www.grucloud.com/docs/cli/PlanApply"},"apply")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc apply\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Querying resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 6/6\n  \u2713 Querying\n    \u2713 VmInstance 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider google                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nDeploying resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Deploying\n    \u2713 VmInstance 1/1\n1 resource deployed of 1 type and 1 provider\nRunning OnDeployedGlobal resources on 1 provider: google\nCommand "gc a -f" executed in 29s\n\n')),(0,r.kt)("p",null,"Congratulations! Your first cloud resource deployed automativally with GruCloud."),(0,r.kt)("p",null,"As always, trust but verify, the newly created server should be accessible through SSH:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute ssh web-server --project vm-tuto1\n")),(0,r.kt)("p",null,"Mission accomplished! The server is installed, up and running."),(0,r.kt)("p",null,"Triple check the instance is running on the ",(0,r.kt)("a",{parentName:"p",href:"https://console.cloud.google.com/compute/instances"},"gcp compute console")),(0,r.kt)("p",null,"Not convinced ? Try with ",(0,r.kt)("em",{parentName:"p"},"gcloud"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gcloud compute instances list --project vm-tuto1\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"NAME        ZONE                  MACHINE_TYPE  PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP   STATUS\nweb-server  southamerica-east1-b  f1-micro                   10.158.0.4   35.198.52.62  RUNNING\n")),(0,r.kt)("p",null,"Does the machine responds our ping request ?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ping 35.198.52.62\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"PING 35.198.52.62 (35.198.52.62): 56 data bytes\n64 bytes from 35.198.52.62: icmp_seq=0 ttl=59 time=176.973 ms\n64 bytes from 35.198.52.62: icmp_seq=1 ttl=59 time=180.442 ms\n64 bytes from 35.198.52.62: icmp_seq=2 ttl=59 time=183.338 ms\n")),(0,r.kt)("p",null,"No firewall is blocking our ping request."),(0,r.kt)("h3",{id:"list"},"List"),(0,r.kt)("p",null,"The command queries the GCP API and lists the available resources. It gives an overall view of the resources under the current project."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"--graph")," options generate a diagram of the live resources, showing their dependencies."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc list --graph\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[...TRUNCATED]\nList Summary:\nProvider: google\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 google                                                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Network            \u2502 default                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Firewall           \u2502 default-allow-icmp                               \u2502\n\u2502                    \u2502 default-allow-internal                           \u2502\n\u2502                    \u2502 default-allow-rdp                                \u2502\n\u2502                    \u2502 default-allow-ssh                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 SubNetwork         \u2502 default                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ServiceAccount     \u2502 571739547473-compute                             \u2502\n\u2502                    \u2502 grucloud                                         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n9 resources, 5 types, 1 provider\nCommand "gc l" executed in 12s\n')),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/google/vm-simple/artifacts/diagram-live.svg",alt:"graph-live-gcp-vm"})),(0,r.kt)("p",null,"Notice the default ",(0,r.kt)("inlineCode",{parentName:"p"},"Network"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Subnet"),", and 4 ",(0,r.kt)("inlineCode",{parentName:"p"},"Firewall")," rules."),(0,r.kt)("p",null,"There are many options to the ",(0,r.kt)("em",{parentName:"p"},"list command"),", for instance, list only the resources created by GruCloud"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc list --our\n")),(0,r.kt)("p",null,"Would you like to display only the virtual machines?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc l -t VmInstance\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Listing resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 6/6\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 VmInstance from google                                                                                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Data                                                                                            \u2502 Our  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 id: 8015745025887516797                                                                         \u2502 Yes  \u2502\n\u2502            \u2502 creationTimestamp: 2021-04-30T15:37:06.858-07:00                                                \u2502      \u2502\n\u2502            \u2502 name: web-server                                                                                \u2502      \u2502\n\u2502            \u2502 tags:                                                                                           \u2502      \u2502\n\u2502            \u2502   fingerprint: 42WmSpB8rSM=                                                                     \u2502      \u2502\n\u2502            \u2502 machineType: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1-\u2026 \u2502      \u2502\n\u2502            \u2502 status: RUNNING                                                                                 \u2502      \u2502\n\u2502            \u2502 zone: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1-b        \u2502      \u2502\n\u2502            \u2502 canIpForward: false                                                                             \u2502      \u2502\n\u2502            \u2502 networkInterfaces:                                                                              \u2502      \u2502\n\u2502            \u2502   - network: https://www.googleapis.com/compute/v1/projects/vm-tuto1/global/networks/default    \u2502      \u2502\n\u2502            \u2502     subnetwork: https://www.googleapis.com/compute/v1/projects/vm-tuto1/regions/southamerica-e\u2026 \u2502      \u2502\n\u2502            \u2502     networkIP: 10.158.0.4                                                                       \u2502      \u2502\n\u2502            \u2502     name: nic0                                                                                  \u2502      \u2502\n\u2502            \u2502     accessConfigs:                                                                              \u2502      \u2502\n\u2502            \u2502       - type: ONE_TO_ONE_NAT                                                                    \u2502      \u2502\n\u2502            \u2502         name: External NAT                                                                      \u2502      \u2502\n\u2502            \u2502         natIP: 35.198.52.62                                                                     \u2502      \u2502\n\u2502            \u2502         networkTier: PREMIUM                                                                    \u2502      \u2502\n\u2502            \u2502         kind: compute#accessConfig                                                              \u2502      \u2502\n\u2502            \u2502     fingerprint: vFCpWqyPPis=                                                                   \u2502      \u2502\n\u2502            \u2502     kind: compute#networkInterface                                                              \u2502      \u2502\n\u2502            \u2502 disks:                                                                                          \u2502      \u2502\n\u2502            \u2502   - type: PERSISTENT                                                                            \u2502      \u2502\n\u2502            \u2502     mode: READ_WRITE                                                                            \u2502      \u2502\n\u2502            \u2502     source: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1-b\u2026 \u2502      \u2502\n\u2502            \u2502     deviceName: web-server-managed-by-gru                                                       \u2502      \u2502\n\u2502            \u2502     index: 0                                                                                    \u2502      \u2502\n\u2502            \u2502     boot: true                                                                                  \u2502      \u2502\n\u2502            \u2502     autoDelete: true                                                                            \u2502      \u2502\n\u2502            \u2502     licenses:                                                                                   \u2502      \u2502\n\u2502            \u2502       - "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/licenses/ubuntu\u2026 \u2502      \u2502\n\u2502            \u2502     interface: SCSI                                                                             \u2502      \u2502\n\u2502            \u2502     guestOsFeatures:                                                                            \u2502      \u2502\n\u2502            \u2502       - type: VIRTIO_SCSI_MULTIQUEUE                                                            \u2502      \u2502\n\u2502            \u2502       - type: SEV_CAPABLE                                                                       \u2502      \u2502\n\u2502            \u2502       - type: UEFI_COMPATIBLE                                                                   \u2502      \u2502\n\u2502            \u2502     diskSizeGb: 20                                                                              \u2502      \u2502\n\u2502            \u2502     kind: compute#attachedDisk                                                                  \u2502      \u2502\n\u2502            \u2502 metadata:                                                                                       \u2502      \u2502\n\u2502            \u2502   fingerprint: xJ9rqloLGTU=                                                                     \u2502      \u2502\n\u2502            \u2502   items:                                                                                        \u2502      \u2502\n\u2502            \u2502     - key: enable-oslogin                                                                       \u2502      \u2502\n\u2502            \u2502       value: True                                                                               \u2502      \u2502\n\u2502            \u2502   kind: compute#metadata                                                                        \u2502      \u2502\n\u2502            \u2502 selfLink: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1-b/i\u2026 \u2502      \u2502\n\u2502            \u2502 scheduling:                                                                                     \u2502      \u2502\n\u2502            \u2502   onHostMaintenance: MIGRATE                                                                    \u2502      \u2502\n\u2502            \u2502   automaticRestart: true                                                                        \u2502      \u2502\n\u2502            \u2502   preemptible: false                                                                            \u2502      \u2502\n\u2502            \u2502 cpuPlatform: Intel Broadwell                                                                    \u2502      \u2502\n\u2502            \u2502 labels:                                                                                         \u2502      \u2502\n\u2502            \u2502   managed-by: grucloud                                                                          \u2502      \u2502\n\u2502            \u2502   stage: dev                                                                                    \u2502      \u2502\n\u2502            \u2502 labelFingerprint: 2XCNew8FA10=                                                                  \u2502      \u2502\n\u2502            \u2502 startRestricted: false                                                                          \u2502      \u2502\n\u2502            \u2502 deletionProtection: false                                                                       \u2502      \u2502\n\u2502            \u2502 reservationAffinity:                                                                            \u2502      \u2502\n\u2502            \u2502   consumeReservationType: ANY_RESERVATION                                                       \u2502      \u2502\n\u2502            \u2502 displayDevice:                                                                                  \u2502      \u2502\n\u2502            \u2502   enableDisplay: false                                                                          \u2502      \u2502\n\u2502            \u2502 shieldedInstanceConfig:                                                                         \u2502      \u2502\n\u2502            \u2502   enableSecureBoot: false                                                                       \u2502      \u2502\n\u2502            \u2502   enableVtpm: true                                                                              \u2502      \u2502\n\u2502            \u2502   enableIntegrityMonitoring: true                                                               \u2502      \u2502\n\u2502            \u2502 shieldedInstanceIntegrityPolicy:                                                                \u2502      \u2502\n\u2502            \u2502   updateAutoLearnPolicy: true                                                                   \u2502      \u2502\n\u2502            \u2502 confidentialInstanceConfig:                                                                     \u2502      \u2502\n\u2502            \u2502   enableConfidentialCompute: false                                                              \u2502      \u2502\n\u2502            \u2502 fingerprint: C1buoQdRfn4=                                                                       \u2502      \u2502\n\u2502            \u2502 lastStartTimestamp: 2021-04-30T15:37:18.374-07:00                                               \u2502      \u2502\n\u2502            \u2502 kind: compute#instance                                                                          \u2502      \u2502\n\u2502            \u2502                                                                                                 \u2502      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\nList Summary:\nProvider: google\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 google                                                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                                                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource, 5 types, 1 provider\nCommand "gc l -t VmInstance" executed in 12s\n')),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"The public address for this machine can be found at the field ",(0,r.kt)("inlineCode",{parentName:"p"},"networkInterfaces[0].accessConfigs[0].natIP"),". Take anote, it will be used later to grab this IP address with the ",(0,r.kt)("inlineCode",{parentName:"p"},"gc output")," command.")),(0,r.kt)("p",null,"Remember the service account created in the ",(0,r.kt)("inlineCode",{parentName:"p"},"init")," phase?"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc l -t ServiceAccount\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Listing resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 2 ServiceAccount from google                                                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name                 \u2502 Data                                                                  \u2502 Our  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 571739547473-compute \u2502 name: projects/vm-tuto1/serviceAccounts/571739547473-compute@develop\u2026 \u2502 NO   \u2502\n\u2502                      \u2502 projectId: vm-tuto1                                                   \u2502      \u2502\n\u2502                      \u2502 uniqueId: 100537252433166772587                                       \u2502      \u2502\n\u2502                      \u2502 email: 571739547473-compute@developer.gserviceaccount.com             \u2502      \u2502\n\u2502                      \u2502 displayName: Compute Engine default service account                   \u2502      \u2502\n\u2502                      \u2502 etag: MDEwMjE5MjA=                                                    \u2502      \u2502\n\u2502                      \u2502 oauth2ClientId: 100537252433166772587                                 \u2502      \u2502\n\u2502                      \u2502 iamPolicy:                                                            \u2502      \u2502\n\u2502                      \u2502   etag: ACAB                                                          \u2502      \u2502\n\u2502                      \u2502                                                                       \u2502      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 grucloud             \u2502 name: projects/vm-tuto1/serviceAccounts/grucloud@vm-tuto1.iam.gservi\u2026 \u2502 NO   \u2502\n\u2502                      \u2502 projectId: vm-tuto1                                                   \u2502      \u2502\n\u2502                      \u2502 uniqueId: 105136741134058242482                                       \u2502      \u2502\n\u2502                      \u2502 email: grucloud@vm-tuto1.iam.gserviceaccount.com                      \u2502      \u2502\n\u2502                      \u2502 displayName: grucloud service account                                 \u2502      \u2502\n\u2502                      \u2502 etag: MDEwMjE5MjA=                                                    \u2502      \u2502\n\u2502                      \u2502 oauth2ClientId: 105136741134058242482                                 \u2502      \u2502\n\u2502                      \u2502 iamPolicy:                                                            \u2502      \u2502\n\u2502                      \u2502   etag: ACAB                                                          \u2502      \u2502\n\u2502                      \u2502                                                                       \u2502      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\nList Summary:\nProvider: google\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 google                                                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ServiceAccount     \u2502 571739547473-compute                                                          \u2502\n\u2502                    \u2502 grucloud                                                                      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n2 resources, 1 type, 1 provider\nCommand "gc l -t ServiceAccount" executed in 5s\n')),(0,r.kt)("p",null,"Notice here GCP has created a default service account for the compute engine."),(0,r.kt)("h3",{id:"update"},"Update"),(0,r.kt)("p",null,"The machine type selected in the first place may be over-sized or under-sized. Let's modify the ",(0,r.kt)("inlineCode",{parentName:"p"},"machineType")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"e2-micro"),", and execute the ",(0,r.kt)("inlineCode",{parentName:"p"},"apply")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"plan")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc plan\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Querying resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 6/6\n  \u2713 Querying\n    \u2713 VmInstance 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 VmInstance from google                                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502 \u2502 UPDATE: name: web-server, id: 8693552609646106284                                       \u2502  \u2502\n\u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502 \u2502 Key: machineType                                                                        \u2502  \u2502\n\u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502 \u2502 - f1-micro                                 \u2502 + f2-micro                                 \u2502  \u2502\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider google                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource to deploy on 1 provider\nCommand "gc p" executed in 6s\n\n')),(0,r.kt)("p",null,"A difference between the live server and its desired state has been detected."),(0,r.kt)("h3",{id:"output"},"Output"),(0,r.kt)("p",null,"In the previous step, the machine's public IP address was discovered with ",(0,r.kt)("em",{parentName:"p"},"gcloud"),", then it was manually cut and pasted to infer to ping command."),(0,r.kt)("p",null,"An alternative way to get the public ip address is with the ",(0,r.kt)("inlineCode",{parentName:"p"},"gc output")," command. Specify a ",(0,r.kt)("inlineCode",{parentName:"p"},"type"),", a ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," and a (nested) field:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc output -t VmInstance --name web-server --field 'networkInterfaces[0].accessConfigs[0].natIP'\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"35.198.52.62\n")),(0,r.kt)("p",null,"Seems to work as expected. Let's combine in one shell command to ping the machine:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"ping `gc output -t VmInstance --name web-server --field 'networkInterfaces[0].accessConfigs[0].natIP'`\n")),(0,r.kt)("h3",{id:"destroy"},"Destroy"),(0,r.kt)("p",null,"When the resources are no longer needed, delete them with the ",(0,r.kt)("inlineCode",{parentName:"p"},"destroy")," command"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"gc destroy\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},'Find Deletable resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Listing 6/6\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 VmInstance from google                                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502 \u2502 DESTROY web-server                                                                      \u2502  \u2502\n\u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524  \u2502\n\u2502 \u2502 id: 4915621396658280948                                                                 \u2502  \u2502\n\u2502 \u2502 creationTimestamp: 2021-05-01T16:41:16.034-07:00                                        \u2502  \u2502\n\u2502 \u2502 name: web-server                                                                        \u2502  \u2502\n\u2502 \u2502 tags:                                                                                   \u2502  \u2502\n\u2502 \u2502   fingerprint: 42WmSpB8rSM=                                                             \u2502  \u2502\n\u2502 \u2502 machineType: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southameric\u2026 \u2502  \u2502\n\u2502 \u2502 status: RUNNING                                                                         \u2502  \u2502\n\u2502 \u2502 zone: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-east1\u2026 \u2502  \u2502\n\u2502 \u2502 canIpForward: false                                                                     \u2502  \u2502\n\u2502 \u2502 networkInterfaces:                                                                      \u2502  \u2502\n\u2502 \u2502   - network: https://www.googleapis.com/compute/v1/projects/vm-tuto1/global/networks/d\u2026 \u2502  \u2502\n\u2502 \u2502     subnetwork: https://www.googleapis.com/compute/v1/projects/vm-tuto1/regions/southa\u2026 \u2502  \u2502\n\u2502 \u2502     networkIP: 10.158.0.6                                                               \u2502  \u2502\n\u2502 \u2502     name: nic0                                                                          \u2502  \u2502\n\u2502 \u2502     accessConfigs:                                                                      \u2502  \u2502\n\u2502 \u2502       - type: ONE_TO_ONE_NAT                                                            \u2502  \u2502\n\u2502 \u2502         name: External NAT                                                              \u2502  \u2502\n\u2502 \u2502         natIP: 35.198.52.62                                                             \u2502  \u2502\n\u2502 \u2502         networkTier: PREMIUM                                                            \u2502  \u2502\n\u2502 \u2502         kind: compute#accessConfig                                                      \u2502  \u2502\n\u2502 \u2502     fingerprint: GzKDoyPVgZI=                                                           \u2502  \u2502\n\u2502 \u2502     kind: compute#networkInterface                                                      \u2502  \u2502\n\u2502 \u2502 disks:                                                                                  \u2502  \u2502\n\u2502 \u2502   - type: PERSISTENT                                                                    \u2502  \u2502\n\u2502 \u2502     mode: READ_WRITE                                                                    \u2502  \u2502\n\u2502 \u2502     source: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica\u2026 \u2502  \u2502\n\u2502 \u2502     deviceName: web-server-managed-by-gru                                               \u2502  \u2502\n\u2502 \u2502     index: 0                                                                            \u2502  \u2502\n\u2502 \u2502     boot: true                                                                          \u2502  \u2502\n\u2502 \u2502     autoDelete: true                                                                    \u2502  \u2502\n\u2502 \u2502     licenses:                                                                           \u2502  \u2502\n\u2502 \u2502       - "https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/license\u2026 \u2502  \u2502\n\u2502 \u2502     interface: SCSI                                                                     \u2502  \u2502\n\u2502 \u2502     guestOsFeatures:                                                                    \u2502  \u2502\n\u2502 \u2502       - type: VIRTIO_SCSI_MULTIQUEUE                                                    \u2502  \u2502\n\u2502 \u2502       - type: SEV_CAPABLE                                                               \u2502  \u2502\n\u2502 \u2502       - type: UEFI_COMPATIBLE                                                           \u2502  \u2502\n\u2502 \u2502     diskSizeGb: 20                                                                      \u2502  \u2502\n\u2502 \u2502     kind: compute#attachedDisk                                                          \u2502  \u2502\n\u2502 \u2502 metadata:                                                                               \u2502  \u2502\n\u2502 \u2502   fingerprint: xJ9rqloLGTU=                                                             \u2502  \u2502\n\u2502 \u2502   items:                                                                                \u2502  \u2502\n\u2502 \u2502     - key: enable-oslogin                                                               \u2502  \u2502\n\u2502 \u2502       value: True                                                                       \u2502  \u2502\n\u2502 \u2502   kind: compute#metadata                                                                \u2502  \u2502\n\u2502 \u2502 selfLink: https://www.googleapis.com/compute/v1/projects/vm-tuto1/zones/southamerica-e\u2026 \u2502  \u2502\n\u2502 \u2502 scheduling:                                                                             \u2502  \u2502\n\u2502 \u2502   onHostMaintenance: MIGRATE                                                            \u2502  \u2502\n\u2502 \u2502   automaticRestart: true                                                                \u2502  \u2502\n\u2502 \u2502   preemptible: false                                                                    \u2502  \u2502\n\u2502 \u2502 cpuPlatform: Intel Broadwell                                                            \u2502  \u2502\n\u2502 \u2502 labels:                                                                                 \u2502  \u2502\n\u2502 \u2502   managed-by: grucloud                                                                  \u2502  \u2502\n\u2502 \u2502   stage: dev                                                                            \u2502  \u2502\n\u2502 \u2502 labelFingerprint: 2XCNew8FA10=                                                          \u2502  \u2502\n\u2502 \u2502 startRestricted: false                                                                  \u2502  \u2502\n\u2502 \u2502 deletionProtection: false                                                               \u2502  \u2502\n\u2502 \u2502 reservationAffinity:                                                                    \u2502  \u2502\n\u2502 \u2502   consumeReservationType: ANY_RESERVATION                                               \u2502  \u2502\n\u2502 \u2502 displayDevice:                                                                          \u2502  \u2502\n\u2502 \u2502   enableDisplay: false                                                                  \u2502  \u2502\n\u2502 \u2502 shieldedInstanceConfig:                                                                 \u2502  \u2502\n\u2502 \u2502   enableSecureBoot: false                                                               \u2502  \u2502\n\u2502 \u2502   enableVtpm: true                                                                      \u2502  \u2502\n\u2502 \u2502   enableIntegrityMonitoring: true                                                       \u2502  \u2502\n\u2502 \u2502 shieldedInstanceIntegrityPolicy:                                                        \u2502  \u2502\n\u2502 \u2502   updateAutoLearnPolicy: true                                                           \u2502  \u2502\n\u2502 \u2502 confidentialInstanceConfig:                                                             \u2502  \u2502\n\u2502 \u2502   enableConfidentialCompute: false                                                      \u2502  \u2502\n\u2502 \u2502 fingerprint: Xh4hKPeAOUk=                                                               \u2502  \u2502\n\u2502 \u2502 lastStartTimestamp: 2021-05-01T16:41:25.313-07:00                                       \u2502  \u2502\n\u2502 \u2502 kind: compute#instance                                                                  \u2502  \u2502\n\u2502 \u2502                                                                                         \u2502  \u2502\n\u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Destroy summary for provider google                                                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 VmInstance         \u2502 web-server                                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n? Are you sure to destroy 1 resource, 1 type on 1 provider? \u203a (y/N)\nDestroying resources on 1 provider: google\n\u2713 google\n  \u2713 Initialising\n  \u2713 Destroying\n    \u2713 VmInstance 1/1\n1 resource destroyed, 1 type on 1 provider\nRunning OnDestroyedGlobal resources on 1 provider: google\nCommand "gc destroy" executed in 46s\n')),(0,r.kt)("p",null,"If the ",(0,r.kt)("inlineCode",{parentName:"p"},"destroy")," command is executed again, no resources should be destroyed."),(0,r.kt)("p",null,"Double-check with ",(0,r.kt)("inlineCode",{parentName:"p"},"gc list --our"),"."),(0,r.kt)("h2",{id:"next-steps"},"Next Steps"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Browse the various ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/tree/main/examples/google"},"examples")," which helps to find out how to use this software.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Available ",(0,r.kt)("a",{parentName:"p",href:"https://grucloud.com/docs/Introduction"},"GCP Resources")))))}m.isMDXComponent=!0}}]);